`go mod` 是 Go 语言的模块管理工具，用于管理依赖包和版本控制。它帮助开发者跟踪项目依赖、自动下载依赖包、更新依赖、定义模块版本等操作。Go 模块系统从 Go 1.11 开始引入，成为了 Go 项目管理的标准方式。以下是 `go mod` 一些基本操作及其用途的介绍。

---

### `go mod` 基本操作的重点提炼表

| 操作                  | 描述                                        | 示例命令                                                     |
| --------------------- | ------------------------------------------- | ------------------------------------------------------------ |
| **初始化模块**        | 初始化项目模块并创建 `go.mod` 文件          | `go mod init <module-name>`                                  |
| **下载依赖**          | 下载项目的所有依赖并生成/更新 `go.sum` 文件 | `go mod tidy`                                                |
| **添加依赖**          | 添加新的依赖包并记录版本                    | 直接在代码中使用 `import "package-name"` 后运行 `go mod tidy` |
| **查看依赖**          | 查看当前模块的依赖关系                      | `go list -m all`                                             |
| **更新依赖**          | 更新依赖包到最新版本                        | `go get -u <module-name>`                                    |
| **移除未使用依赖**    | 自动移除未使用的依赖                        | `go mod tidy`                                                |
| **启用/禁用模块代理** | 配置是否使用 Go 模块代理                    | `GO111MODULE=on`/`GO111MODULE=off`                           |

---

### 1. **初始化模块**

使用 `go mod init` 命令初始化一个新的模块。此命令会在当前目录下创建一个 `go.mod` 文件，用来记录模块名和项目的依赖信息。`go.mod` 文件类似于其他语言中的 `package.json` 或 `requirements.txt`，用于定义项目的依赖包和模块版本。

#### 示例：

```bash
go mod init example.com/myproject
```

#### 解释：
- `example.com/myproject` 是模块名，通常使用路径来命名模块，可以是任意合法的名称。
- 初始化后，会生成 `go.mod` 文件，记录模块名和 Go 版本信息。

`go.mod` 文件内容示例：

```go
module example.com/myproject

go 1.18
```

---

### 2. **下载依赖**

当项目中使用了新的依赖包（如导入第三方包）时，可以运行 `go mod tidy` 命令来自动下载所有需要的依赖包，并更新 `go.mod` 和 `go.sum` 文件。`go.sum` 文件记录了所有依赖包的哈希值，确保依赖版本的一致性。

#### 示例：

```bash
go mod tidy
```

#### 解释：
- `go mod tidy` 会扫描项目中所有的导入包，下载缺失的依赖，并移除未使用的依赖。它还会更新 `go.sum` 文件。

---

### 3. **添加依赖**

在 Go 模块中，当你在代码中使用一个新的第三方包（即导入一个新的包）时，Go 会自动尝试查找该包，并将其版本信息记录在 `go.mod` 文件中。可以通过 `go mod tidy` 命令来确保依赖关系被正确记录。

#### 示例：

```go
import "github.com/gorilla/mux"
```

运行以下命令来更新依赖：

```bash
go mod tidy
```

#### 解释：
- `go mod tidy` 之后，`go.mod` 文件会自动更新，记录新增的包及其版本信息。
- 该包及其依赖会被下载并存储在本地缓存中。

---

### 4. **查看依赖**

使用 `go list -m all` 命令可以查看当前模块的所有依赖项及其版本。

#### 示例：

```bash
go list -m all
```

#### 解释：
- 该命令列出了当前模块及其所有依赖项的模块名称和版本信息。
- 可以用来查看当前模块使用了哪些第三方库及其具体版本。

输出示例：

```bash
example.com/myproject
github.com/gorilla/mux v1.8.0
```

---

### 5. **更新依赖**

使用 `go get` 命令可以更新依赖包的版本，`go get` 支持指定版本的包更新。

#### 更新到最新版本：

```bash
go get -u github.com/gorilla/mux
```

#### 更新到指定版本：

```bash
go get github.com/gorilla/mux@v1.7.0
```

#### 解释：
- `go get -u`：更新包到最新的次要版本（`v1.x` 到 `v1.y`）。
- `go get @version`：更新包到指定的版本，如 `@v1.7.0`。

更新后的 `go.mod` 文件会自动记录新版本信息。

---

### 6. **移除未使用的依赖**

在项目中，如果有些依赖不再被使用，运行 `go mod tidy` 可以自动移除这些依赖，并更新 `go.mod` 和 `go.sum` 文件。

#### 示例：

```bash
go mod tidy
```

#### 解释：
- `go mod tidy` 会自动清理未使用的依赖包，并确保 `go.mod` 和 `go.sum` 文件保持最新状态。

---

### 7. **启用/禁用模块代理**

Go 语言有一个模块代理机制，用来加速依赖包的下载。可以通过环境变量 `GO111MODULE` 来控制模块的启用和禁用。

- **启用模块模式**（默认从 Go 1.16 开始）：

```bash
GO111MODULE=on
```

- **禁用模块模式**：

```bash
GO111MODULE=off
```

#### **解释**：
- `GO111MODULE=on`：强制启用模块模式，即使是在 `$GOPATH` 内部，也使用模块管理依赖。
- `GO111MODULE=off`：关闭模块模式，所有依赖使用传统的 `GOPATH` 管理方式。
- `GO111MODULE=auto`：根据环境自动选择模块模式，在 `$GOPATH` 外部启用，在 `$GOPATH` 内部禁用。

---

### 总结

- **初始化模块**：使用 `go mod init` 创建项目的模块文件 `go.mod`。
- **下载依赖**：使用 `go mod tidy` 下载和更新依赖包。
- **添加依赖**：通过 `import` 第三方包，并使用 `go mod tidy` 确保依赖更新。
- **查看依赖**：使用 `go list -m all` 查看所有依赖包及其版本。
- **更新依赖**：使用 `go get` 更新依赖到最新版本或指定版本。
- **移除未使用依赖**：使用 `go mod tidy` 自动移除未使用的依赖。
- **启用/禁用模块代理**：通过 `GO111MODULE` 环境变量控制模块代理的启用和禁用。

